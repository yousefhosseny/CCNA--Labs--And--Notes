### عملية OSPF (OSPF Operation)
الفيديو (اللي مش موجود هنا، بس النص بيشرحه) بيتكلم عن 7 حالات (states) في عملية OSPF عشان الراوترات تتواصل وتبني الشبكة. OSPF يمر بالحالات دي عشان يقيم جوار (adjacencies) ويزامن قواعد البيانات. هي زي خطوات بناء صداقة بين الراوترات: من عدم معرفة لبعض، لحد ما يعرفوا كل حاجة عن الشبكة.

#### الحالات التشغيلية لـ OSPF (Operational States)
هنا جدول بسيط لكل حالة ووصفها:

| الحالة | الوصف البسيط |
|---------|--------------|
| **Down State** | مفيش حزم Hello وصلت. الراوتر يبدأ يرسل Hello، ويروح لـ Init. |
| **Init State** | وصل Hello من جار، فيه ID الراوتر المرسل. يروح لـ Two-Way. |
| **Two-Way State** | الاتصال ثنائي (bidirectional). في الشبكات متعددة الوصول (زي Ethernet)، ينتخب DR وBDR. يروح لـ ExStart. |
| **ExStart State** | في الروابط نقطة لنقطة، يقرروا مين يبدأ تبادل DBD ويحددوا رقم التسلسل. |
| **Exchange State** | يتبادلوا DBD (وصف قاعدة البيانات). لو محتاج معلومات إضافية، يروح لـ Loading؛ غير كده، لـ Full. |
| **Loading State** | يرسلوا LSR (طلب) وLSU (تحديث) عشان يجيبوا معلومات إضافية. يحسب الطرق بـ SPF، ثم يروح لـ Full. |
| **Full State** | قاعدة البيانات LSDB متزامنة تماماً. الراوترات جاهزة للعمل. |

#### إقامة الجوار (Establish Neighbor Adjacencies)
- الراوتر يرسل Hello packets (مع ID الخاص به) لعنوان multicast 224.0.0.5 عشان يكتشف جيران.
- الـ Router ID: رقم 32-bit زي عنوان IPv4، يحدد الراوتر فريداً في المنطقة.
- لو راوتر تاني شاف Hello جديد، يحاول يقيم جوار.

عملية الجوار في شبكة متعددة الوصول (مثال بين راوترين R1 وR2):
1. **Down to Init**: R1 يرسل Hello عشان يبحث عن جيران.
2. **Init**: R2 يستلم Hello، يضيف ID R1 لقائمته، ويرد بـ Hello مع IDه.
3. **Two-Way**: R1 يشوف IDه في Hello من R2، يضيف R2، والاتصال ثنائي. لو نقطة لنقطة، يروح ExStart. لو Ethernet، ينتخب DR/BDR.
4. **انتخاب DR وBDR**: الراوتر مع أعلى ID أو أولوية (priority) يبقى DR (رئيسي)، والتاني BDR (مساعد).

#### مزامنة قواعد البيانات (Synchronizing OSPF Databases)
بعد Two-Way، يروحوا لمزامنة:
- **قرر مين الأول**: الراوتر مع أعلى ID يبدأ يرسل DBD.
- **تبادل DBD**: يرسلوا وصف قواعدهم، ويؤكدوا بـ LSAck.
- **طلب إضافي**: لو في معلومات أحدث، يرسلوا LSR، ثم LSU للرد.
- بعد كل ده، يبقوا Full، والتحديثات تيجي فقط لو في تغيير (incremental) أو كل 30 دقيقة.

#### الحاجة لـ DR (Designated Router)
في الشبكات متعددة الوصول (multiaccess زي Ethernet):
- مشكلة: لو كتير راوترات، هيتبادلوا LSAs كتير جداً، ده يسبب فوضى وتحميل عالي.
- حل: انتخاب DR كمركز لجمع وتوزيع LSAs. BDR احتياطي لو DR فشل. الباقي DROTHERs (مش DR أو BDR).
- الـ DR مش لتوجيه البيانات العادية، بس لنشر LSAs. التوجيه لسة بناءً على جدول التوجيه.

![[Pasted image 20260106034435.png]]


باختصار، OSPF زي لعبة فريق: يبدأوا يتعرفوا (Hello)، يتفقوا (انتخاب DR)، يشاركوا معلومات (مزامنة)، ويشتغلوا مع بعض بكفاءة بدون فوضى. لو عايز رسم أو مثال عملي، قل!